# =============================================================================
# Spark Configuration for Scholarly Knowledge Graph
# =============================================================================

# Master URL (set via environment in Docker)
# spark.master                     spark://spark-master:7077

# Application name (default, overridden by jobs)
spark.app.name                   ScholarlyKG

# Executor Configuration
spark.executor.memory            2g
spark.executor.cores             2

# Driver Configuration
spark.driver.memory              2g
spark.driver.maxResultSize       1g

# Shuffle Configuration
spark.sql.shuffle.partitions     100
spark.default.parallelism        100

# Adaptive Query Execution (Spark 3.x)
spark.sql.adaptive.enabled       true
spark.sql.adaptive.coalescePartitions.enabled  true
spark.sql.adaptive.skewJoin.enabled  true

# Memory Management
spark.memory.fraction            0.8
spark.memory.storageFraction     0.3

# Serialization
spark.serializer                 org.apache.spark.serializer.KryoSerializer
spark.kryoserializer.buffer.max  256m

# Parquet Configuration
spark.sql.parquet.compression.codec  snappy
spark.sql.parquet.mergeSchema    true
spark.sql.parquet.filterPushdown true

# HDFS Configuration
spark.hadoop.fs.defaultFS        hdfs://namenode:9000

# Event Logging (for Spark UI history)
spark.eventLog.enabled           true
spark.eventLog.dir               /opt/bitnami/spark/logs

# Network Configuration
spark.network.timeout            600s
spark.executor.heartbeatInterval 100s

# GraphFrames
spark.jars.packages              graphframes:graphframes:0.8.3-spark3.5-s_2.12

# Python Configuration
spark.pyspark.python             python3
spark.pyspark.driver.python      python3

